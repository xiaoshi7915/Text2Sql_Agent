"use strict";(self["webpackChunkwenshu_mcp_frontend"]=self["webpackChunkwenshu_mcp_frontend"]||[]).push([[883],{883:function(e,a,t){t.r(a),t.d(a,{default:function(){return f}});var l=t(6768),n=t(4232);const s={class:"datasource-list-container"},r={class:"header-actions"},o={class:"filter-container"},u={class:"name-container"},d={class:"name-text"},c={class:"pagination-container"};function i(e,a,t,i,p,b){const g=(0,l.g2)("icon-plus"),h=(0,l.g2)("el-icon"),v=(0,l.g2)("el-button"),m=(0,l.g2)("icon-search"),y=(0,l.g2)("el-input"),f=(0,l.g2)("el-option"),k=(0,l.g2)("el-select"),C=(0,l.g2)("el-tag"),S=(0,l.g2)("el-table-column"),_=(0,l.g2)("icon-edit"),F=(0,l.g2)("icon-connection"),L=(0,l.g2)("icon-delete"),w=(0,l.g2)("el-table"),T=(0,l.g2)("el-pagination"),z=(0,l.gN)("loading");return(0,l.uX)(),(0,l.CE)("div",s,[(0,l.Lk)("div",r,[(0,l.bF)(v,{type:"primary",onClick:i.handleCreate},{default:(0,l.k6)((()=>[(0,l.bF)(h,null,{default:(0,l.k6)((()=>[(0,l.bF)(g)])),_:1}),a[5]||(a[5]=(0,l.Lk)("span",null,"新建数据源",-1))])),_:1},8,["onClick"]),(0,l.bF)(y,{modelValue:i.searchKeyword,"onUpdate:modelValue":a[0]||(a[0]=e=>i.searchKeyword=e),placeholder:"搜索数据源名称",class:"search-input",clearable:"",onClear:i.handleSearch,onInput:i.handleSearch},{prefix:(0,l.k6)((()=>[(0,l.bF)(h,null,{default:(0,l.k6)((()=>[(0,l.bF)(m)])),_:1})])),_:1},8,["modelValue","onClear","onInput"])]),(0,l.Lk)("div",o,[(0,l.bF)(k,{modelValue:i.filters.type,"onUpdate:modelValue":a[1]||(a[1]=e=>i.filters.type=e),placeholder:"数据库类型",clearable:"",onChange:i.handleFilter},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(i.dbTypeOptions,(e=>((0,l.uX)(),(0,l.Wv)(f,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"]),(0,l.bF)(k,{modelValue:i.filters.status,"onUpdate:modelValue":a[2]||(a[2]=e=>i.filters.status=e),placeholder:"连接状态",clearable:"",onChange:i.handleFilter},{default:(0,l.k6)((()=>[(0,l.bF)(f,{label:"已连接",value:"connected"}),(0,l.bF)(f,{label:"未连接",value:"disconnected"})])),_:1},8,["modelValue","onChange"])]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(w,{data:i.filteredDataSources,border:"",style:{width:"100%"},"header-cell-style":{backgroundColor:"#f5f7fa"}},{default:(0,l.k6)((()=>[(0,l.bF)(S,{label:"数据源名称",prop:"name","min-width":"150"},{default:(0,l.k6)((({row:e})=>[(0,l.Lk)("div",u,[(0,l.bF)(C,{size:"small",type:i.getDbTypeTag(e.type)},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(e.type),1)])),_:2},1032,["type"]),(0,l.Lk)("span",d,(0,n.v_)(e.name),1)])])),_:1}),(0,l.bF)(S,{label:"主机地址",prop:"host","min-width":"150"}),(0,l.bF)(S,{label:"数据库名",prop:"database","min-width":"120"}),(0,l.bF)(S,{label:"表数量",prop:"tableCount",width:"100",align:"center"}),(0,l.bF)(S,{label:"连接状态",width:"120",align:"center"},{default:(0,l.k6)((({row:e})=>[(0,l.bF)(C,{type:"connected"===e.status?"success":"danger",size:"small"},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)("connected"===e.status?"已连接":"未连接"),1)])),_:2},1032,["type"])])),_:1}),(0,l.bF)(S,{label:"最后更新时间",width:"180",align:"center"},{default:(0,l.k6)((({row:e})=>[(0,l.eW)((0,n.v_)(i.formatDate(e.updatedAt)),1)])),_:1}),(0,l.bF)(S,{label:"操作",width:"240",align:"center"},{default:(0,l.k6)((({row:e})=>[(0,l.bF)(v,{size:"small",type:"primary",plain:"",onClick:a=>i.handleEdit(e)},{default:(0,l.k6)((()=>[(0,l.bF)(h,null,{default:(0,l.k6)((()=>[(0,l.bF)(_)])),_:1}),a[6]||(a[6]=(0,l.Lk)("span",null,"编辑",-1))])),_:2},1032,["onClick"]),(0,l.bF)(v,{size:"small",type:"success",plain:"",onClick:a=>i.handleTest(e)},{default:(0,l.k6)((()=>[(0,l.bF)(h,null,{default:(0,l.k6)((()=>[(0,l.bF)(F)])),_:1}),a[7]||(a[7]=(0,l.Lk)("span",null,"测试",-1))])),_:2},1032,["onClick"]),(0,l.bF)(v,{size:"small",type:"danger",plain:"",onClick:a=>i.handleDelete(e)},{default:(0,l.k6)((()=>[(0,l.bF)(h,null,{default:(0,l.k6)((()=>[(0,l.bF)(L)])),_:1}),a[8]||(a[8]=(0,l.Lk)("span",null,"删除",-1))])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[z,i.loading]]),(0,l.Lk)("div",c,[(0,l.bF)(T,{"current-page":i.currentPage,"onUpdate:currentPage":a[3]||(a[3]=e=>i.currentPage=e),"page-size":i.pageSize,"onUpdate:pageSize":a[4]||(a[4]=e=>i.pageSize=e),"page-sizes":[10,20,50,100],total:i.totalCount,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:i.handleSizeChange,onCurrentChange:i.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])])}t(4114),t(8111),t(2489);var p=t(144),b=t(1387),g=t(1219),h=t(2933),v={name:"DataSourceList",setup(){const e=(0,b.rd)(),a=(0,p.KR)(!1),t=(0,p.KR)(""),n=(0,p.KR)({type:"",status:""}),s=(0,p.KR)(1),r=(0,p.KR)(10),o=(0,p.KR)(0),u=(0,p.KR)([{id:1,name:"生产环境MySQL数据库",type:"MySQL",host:"192.168.1.100",port:3306,database:"production_db",username:"root",password:"******",tableCount:32,status:"connected",createdAt:"2023-11-05T08:30:00Z",updatedAt:"2023-11-06T15:45:00Z"},{id:2,name:"测试环境PostgreSQL",type:"PostgreSQL",host:"192.168.1.101",port:5432,database:"test_db",username:"postgres",password:"******",tableCount:18,status:"connected",createdAt:"2023-11-03T10:20:00Z",updatedAt:"2023-11-06T14:30:00Z"},{id:3,name:"开发环境SQL Server",type:"SQLServer",host:"192.168.1.102",port:1433,database:"dev_db",username:"sa",password:"******",tableCount:25,status:"disconnected",createdAt:"2023-11-02T14:10:00Z",updatedAt:"2023-11-04T09:15:00Z"},{id:4,name:"历史数据Oracle",type:"Oracle",host:"192.168.1.103",port:1521,database:"history_db",username:"system",password:"******",tableCount:45,status:"connected",createdAt:"2023-10-28T11:25:00Z",updatedAt:"2023-11-05T16:40:00Z"},{id:5,name:"分析环境MySQL",type:"MySQL",host:"192.168.1.104",port:3306,database:"analytics_db",username:"analytics_user",password:"******",tableCount:12,status:"disconnected",createdAt:"2023-11-01T13:50:00Z",updatedAt:"2023-11-03T10:25:00Z"}]),d=[{value:"MySQL",label:"MySQL"},{value:"PostgreSQL",label:"PostgreSQL"},{value:"SQLServer",label:"SQL Server"},{value:"Oracle",label:"Oracle"}],c=(0,l.EW)((()=>{let e=[...u.value];if(t.value){const a=t.value.toLowerCase();e=e.filter((e=>e.name.toLowerCase().includes(a)||e.host.toLowerCase().includes(a)||e.database.toLowerCase().includes(a)))}n.value.type&&(e=e.filter((e=>e.type===n.value.type))),n.value.status&&(e=e.filter((e=>e.status===n.value.status))),o.value=e.length;const a=(s.value-1)*r.value;return e.slice(a,a+r.value)})),i=e=>{if(!e)return"-";const a=new Date(e);return a.toLocaleString()},v=e=>{const a={MySQL:"primary",PostgreSQL:"success",SQLServer:"warning",Oracle:"danger"};return a[e]||"info"},m=()=>{s.value=1},y=()=>{s.value=1},f=e=>{r.value=e,s.value=1},k=e=>{s.value=e},C=()=>{e.push("/datasource/create")},S=a=>{e.push(`/datasource/edit/${a.id}`)},_=e=>{a.value=!0,setTimeout((()=>{a.value=!1,"connected"===e.status?(0,g.nk)({message:`成功连接到数据源 ${e.name}`,type:"success"}):(0,g.nk)({message:`无法连接到数据源 ${e.name}，请检查配置`,type:"error"})}),1e3)},F=e=>{h.s.confirm(`确定要删除数据源 "${e.name}" 吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{u.value=u.value.filter((a=>a.id!==e.id)),(0,g.nk)({type:"success",message:"删除成功"})})).catch((()=>{}))},L=()=>{a.value=!0,setTimeout((()=>{a.value=!1}),500)};return(0,l.sV)((()=>{L()})),{loading:a,searchKeyword:t,filters:n,currentPage:s,pageSize:r,totalCount:o,dataSources:u,filteredDataSources:c,dbTypeOptions:d,formatDate:i,getDbTypeTag:v,handleSearch:m,handleFilter:y,handleSizeChange:f,handleCurrentChange:k,handleCreate:C,handleEdit:S,handleTest:_,handleDelete:F}}},m=t(1241);const y=(0,m.A)(v,[["render",i],["__scopeId","data-v-2673e245"]]);var f=y}}]);
//# sourceMappingURL=883.bff1a53c.js.map